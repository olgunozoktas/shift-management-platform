import"./bootstrap.32611946.js";import{c as L,j as t,r as c,a as r,F as z,I as M}from"./jsx-runtime.5cafaefb.js";import{n as h}from"./Notification.c6a390b7.js";function W({applicationId:i}){const[s,v]=c.exports.useState(null),[a,p]=c.exports.useState([]),[g,j]=c.exports.useState([]),[f,y]=c.exports.useState([]),[N,x]=c.exports.useState(null),[_,b]=c.exports.useState(null),[u,w]=c.exports.useState(null),[C,k]=c.exports.useState(null),[A,S]=c.exports.useState(null);c.exports.useEffect(()=>{D(),R(),F()},[]);function D(){axios.get("/application/"+i+"/show").then(e=>{v(e.data);let o=e.data.user.user_documents;p(o.filter(n=>n.status==="pending"||n.status==="approved"))}).catch(e=>{console.log(e)})}function R(){axios.get("/api/v1/companies").then(e=>{j(e.data),x(e.data[0].id)}).catch(e=>{console.log(e)})}function F(){axios.get("/api/v1/job-roles").then(e=>{y(e.data),b(e.data[0].id)}).catch(e=>{console.log(e)})}function I(e){const o=[...a],n=o.findIndex(l=>l.id===e);o[n].is_approved=!0,o[n].is_rejected=!1,p(o)}function J(e){const o=[...a],n=o.findIndex(l=>l.id===e);o[n].is_rejected=!0,o[n].is_approved=!1,p(o)}const d=(e,o=null)=>{if(e.target.name==="reject"){const n=[...a],l=n.findIndex(E=>E.id===o);n[l].reject_reason=e.target.value,p(n)}else e.target.name==="company"?x(e.target.value):e.target.name==="job-role"?b(e.target.value):e.target.name==="reject-reason"?w(e.target.value):e.target.name==="phone-no"?k(e.target.value):e.target.name==="company-phone-no"&&S(e.target.value)};function P(){let e={};e.selected_company_id=N,e.selected_job_role_id=_,e.phone_no=C,e.company_phone_no=A,axios.post("/application/"+i+"/approve",e).then(o=>{o.data.status==="success"?window.location="/applications":h(o.data.message)}).catch(o=>{console.log(o)})}function B(){const e=a.filter(l=>l.is_rejected===!0),o=a.filter(l=>l.is_approved===!0);if(e.length+o.length!==a.length){h("All documents have to be processed (approved or rejected)");return}if(u==null||u===""||u.length===0){h("Reject reason must be entered");return}let n={};n.rejected_documents=a.filter(l=>l.is_rejected===!0),n.reject_reason=u,axios.post("/application/"+i+"/reject",n).then(l=>{l.data.status==="success"?window.location="/applications":h(l.data.message)}).catch(l=>{console.log(l)})}return r(z,{children:[t(M,{position:"top-right",reverseOrder:!0,gutter:8,containerClassName:"",containerStyle:{}}),(s==null?void 0:s.status)==="pending"?r("div",{className:"flex flex-col gap-2",children:[t("h1",{className:"text-lg text-black font-black my-4",children:"In order to approve the application first of all you have to approve all uploaded documents."}),t("div",{className:"grid grid-cols-2 gap-2",children:a.map(e=>r("div",{className:"flex flex-col items-center gap-4 border border-gray-200 py-4",children:[t("p",{className:"border-b border-black",children:e.document_type.definition}),e.is_image?t("a",{href:"/user-documents/"+e.id,target:"_blank",className:"w-full h-48",children:t("img",{src:"/user-documents/"+e.id,alt:"",className:"w-full h-full"})}):null,e.is_document?t("a",{href:"/user-documents/"+e.id,children:"Download Document"}):null,e.is_pdf?t("iframe",{src:"/user-documents/"+e.id,frameBorder:"0",className:"w-full"}):null,r("div",{className:"flex flex-row gap-2",children:[t("button",{className:"py-2 px-4 rounded-2xl text-white "+(e.is_approved?"bg-green-500 hover:bg-green-600":"bg-blue-500 hover:bg-blue-600"),onClick:()=>I(e.id),children:e.is_approved?"Approved":"Approve"}),t("button",{className:"py-2 px-4 rounded-2xl text-white "+(e.is_rejected?"bg-red-500 hover:bg-red-600":"bg-gray-500 hover:bg-gray-600"),onClick:()=>J(e.id),children:e.is_rejected?"Rejected":"Reject"})]})]},e.id))}),a.filter(e=>e.is_approved===!0).length===a.length?r("div",{className:"flex flex-col gap-4 mt-4",children:[g.length>0?r("div",{className:"flex flex-col gap-2",children:[t("label",{htmlFor:"company",children:"Select Company"}),t("select",{name:"company",id:"company",onChange:d,className:"rounded-lg",children:g.map(e=>t("option",{value:e.id,children:e.name}))})]}):null,f.length>0?r("div",{className:"flex flex-col gap-2",children:[t("label",{htmlFor:"job-role",children:"Select Job Role"}),t("select",{name:"job-role",id:"job-role",onChange:d,className:"rounded-lg",children:f.map(e=>t("option",{value:e.id,children:e.definition}))})]}):null,t("label",{htmlFor:"phone-no",children:"Phone Number (Country code must be entered)"}),t("input",{type:"tel",className:"rounded-lg",placeholder:"+90 533 555 444 44 44",name:"phone-no",onChange:d}),t("label",{htmlFor:"company-phone-no",children:"Company Phone Number (Country code must be entered)"}),t("input",{type:"tel",className:"rounded-lg",placeholder:"+90 533 555 444 44 44",name:"company-phone-no",onChange:d})]}):null,a.filter(e=>e.is_rejected===!0).length>0?t("textarea",{name:"reject-reason",onChange:e=>d(e,document.id),cols:"30",rows:"10",className:"rounded-2xl",placeholder:"Enter reject reason"}):null,r("div",{className:"flex flex-row justify-end gap-2 mt-4",children:[a.filter(e=>e.is_approved===!0).length===a.length?t("button",{className:"py-2 px-4 rounded-2xl text-white bg-green-500 hover:bg-green-600",onClick:P,children:"Approve Application"}):null,a.filter(e=>e.is_rejected===!0).length>0?t("button",{className:"py-2 px-4 rounded-2xl text-white bg-red-500 hover:bg-red-600",onClick:B,children:"Reject Application"}):null]})]}):r("div",{className:"flex flex-col text-center h-24 mt-12 items-center justify-center",children:[(s==null?void 0:s.status)==="approved"?r("div",{className:"flex flex-col items-center justify-center gap-2",children:[t("svg",{className:"w-24 h-24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Application Approved"]}):null,(s==null?void 0:s.status)==="rejected"?r("div",{className:"flex flex-col items-center justify-center gap-2",children:[t("svg",{className:"w-24 h-24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Application Rejected"]}):null]})]})}let m=document.getElementById("application");if(m){const i=m.getAttribute("data-id");L(m).render(t(W,{applicationId:i}))}
